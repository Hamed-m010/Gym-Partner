<!DOCTYPE html>
<html lang="no">
<head>
<meta charset="UTF-8">
<title>Gym Tinder üí™</title>

<style>
body {
    margin: 0;
    font-family: Arial, sans-serif;
    background: #111;
    color: white;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
}

.hidden { display: none; }

.app {
    width: 360px;
    background: #1e1e1e;
    border-radius: 15px;
    padding: 20px;
    box-shadow: 0 0 20px black;
}

input, button {
    width: 100%;
    padding: 10px;
    margin: 6px 0;
    border-radius: 6px;
    border: none;
}

button {
    background: #4dff88;
    font-weight: bold;
    cursor: pointer;
}

button.nope {
    background: #ff4d4d;
    color: white;
}

.card img {
    width: 100%;
    height: 220px;
    object-fit: cover;
    border-radius: 10px;
}

.buttons {
    display: flex;
    gap: 10px;
    margin-top: 10px;
}

.chat {
    height: 300px;
    background: #2a2a2a;
    border-radius: 10px;
    padding: 10px;
    overflow-y: auto;
    margin-bottom: 10px;
}

.msg {
    margin: 5px 0;
}

.me { color: #4dff88; }
.them { color: #fff; }

#preview {
    width: 100%;
    border-radius: 10px;
    margin-top: 10px;
    display: none;
}
</style>
</head>
<body>

<!-- OPPRETT PROFIL -->
<div class="app" id="createProfile">
    <h2>Lag profil</h2>
    <input id="userName" placeholder="Navn">
    <input id="userBio" placeholder="Bio (f.eks. Bryst & rygg)">
    <input type="file" id="userImg" accept="image/*">
    <img id="preview">
    <button onclick="createProfile()">Opprett profil</button>
</div>

<!-- SWIPE -->
<div class="app hidden" id="swipe">
    <div class="card">
        <img id="profileImg">
        <h3 id="profileName"></h3>
        <p id="profileBio"></p>
    </div>

    <div class="buttons">
        <button class="nope" onclick="swipe(false)">‚ùå</button>
        <button onclick="swipe(true)">‚ù§Ô∏è</button>
    </div>

    <p id="matchMsg"></p>
</div>

<!-- CHAT -->
<div class="app hidden" id="chat">
    <h3>Chat med <span id="chatName"></span></h3>
    <div class="chat" id="chatBox"></div>
    <input id="chatInput" placeholder="Skriv melding...">
    <button onclick="sendMsg()">Send</button>
</div>

<script>
/* ---------------- DATA ---------------- */
let users = []; // Liste over profiler
let currentUser = null; // Profil vi laget
let index = 0;
let matchedUser = null;
let uploadedImage = "";

/* ---------------- BILDE OPPLASTING ---------------- */
const userImgInput = document.getElementById("userImg");
const previewImg = document.getElementById("preview");

userImgInput.addEventListener("change", function () {
    const file = this.files[0];
    if (!file) return;

    const reader = new FileReader();
    reader.onload = e => {
        uploadedImage = e.target.result;
        previewImg.src = uploadedImage;
        previewImg.style.display = "block";
    };
    reader.readAsDataURL(file);
});

/* ---------------- OPPRETT PROFIL ---------------- */
function createProfile() {
    const name = document.getElementById("userName").value.trim();
    const bio = document.getElementById("userBio").value.trim();

    if (!name || !uploadedImage) {
        alert("Fyll inn navn og last opp bilde!");
        return;
    }

    currentUser = { name, bio, img: uploadedImage };
    users.push(currentUser);

    document.getElementById("createProfile").classList.add("hidden");
    document.getElementById("swipe").classList.remove("hidden");

    // Legg til noen demo-profiler
    users.push(
        { name: "Sara", bio: "Bein & cardio", img: "https://images.unsplash.com/photo-1594737625785-c5c6f33b6d07" },
        { name: "Jonas", bio: "Powerlifting", img: "https://images.unsplash.com/photo-1599058917212-d750089bc07a" },
        { name: "Mia", bio: "CrossFit", img: "https://images.unsplash.com/photo-1594737625754-8b8b1226e6b2" }
    );

    loadProfile();
}

/* ---------------- SWIPE ---------------- */
function loadProfile() {
    document.getElementById("matchMsg").textContent = "";

    if (index >= users.length) {
        document.getElementById("matchMsg").textContent = "Ingen flere profiler üò¢";
        return;
    }

    const p = users[index];
    if (p.name === currentUser.name) {
        index++; // Hopp over egen profil
        loadProfile();
        return;
    }

    document.getElementById("profileImg").src = p.img;
    document.getElementById("profileName").textContent = p.name;
    document.getElementById("profileBio").textContent = p.bio;
}

function swipe(like) {
    const p = users[index];
    if (like && Math.random() > 0.5) {
        matchedUser = p;
        document.getElementById("matchMsg").textContent = "üéâ MATCH!";
        setTimeout(openChat, 800);
        return;
    }
    index++;
    loadProfile();
}

/* ---------------- CHAT ---------------- */
function openChat() {
    document.getElementById("swipe").classList.add("hidden");
    document.getElementById("chat").classList.remove("hidden");
    document.getElementById("chatName").textContent = matchedUser.name;
}

function sendMsg() {
    const input = document.getElementById("chatInput");
    const msg = input.value.trim();
    if (!msg) return;

    const chatBox = document.getElementById("chatBox");
    chatBox.innerHTML += `<div class="msg me">Du: ${msg}</div>`;
    input.value = "";

    setTimeout(() => {
        chatBox.innerHTML += `<div class="msg them">${matchedUser.name}: Haha, nice üí™</div>`;
        chatBox.scrollTop = chatBox.scrollHeight;
    }, 600);
}
</script>

</body>
</html>
